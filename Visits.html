<!DOCTYPE html>
<html lang="en">

<head>
    <title id='Description'>With jqxGrid, you can export your data to Excel, XML, CSV, TSV, JSON, PDF and HTML.</title>
    <meta name="description" content="jQuery Grid Data Export to Excel, PDF, XML, CSV, TSV, JSON and HTML" />
    <link rel="stylesheet" href="../../jqwidgets/styles/jqx.base.css" type="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1 minimum-scale=1" />
    <script type="text/javascript" src="../../scripts/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxcore.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxbuttons.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxscrollbar.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxmenu.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxgrid.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxgrid.selection.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxgrid.columnsresize.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxdata.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxdata.export.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxgrid.export.js"></script>
    <script type="text/javascript" src="../../jqwidgets/jqxgrid.sort.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxdatetimeinput.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxcalendar.js"></script>
    <script type="text/javascript" src="../../scripts/demos.js"></script>
    <script type="text/javascript" src="scripts/date.js"></script>
    <script type="text/javascript" src="jqwidgets/jqxtooltip.js"></script>

    <script type="text/javascript">
        
        
        //     //prefer to use l.search if you have a location/link object
        //         //reverse iteration as may be destructive
              
    </script>
</head>

<body class='default' style="text-align: center"> 
    <div id='jqxDateTimeInput'></div>
    <div id='jqxDateTimeInputTo'></div>
    <div id="grid" style="text-align: center"></div>
    <div style='margin-top: 20px;'>
        <div style='float: left;'>
            <input type="button" value="Export to Excel" id='excelExport' />
        </div>
        <div style='margin-left: 10px; float: left;'>
            <input type="button" value="Export to CSV" id='csvExport' />
        </div>
        <div style='margin-left: 10px; float: left;'>
            <input type="button" value="Export to PDF" id='pdfExport' />
        </div>
        <div style='margin-left: 10px; float: left;'>
            <input type="button" value="Export to XML" id='xmlExport' />
        </div>
        <div style='margin-left: 10px; float: left;'>
            <input type="button" value="Export to TSV" id='tsvExport' />
        </div>
        <div style='margin-left: 10px; float: left;'>
            <input type="button" value="Export to JSON" id='jsonExport' />
        </div>
    </div>
    <script type="text/javascript">


        $(document).ready(function () {

            var fromDate = new Date.today();
            var toDate = new Date.today().addDays(1);


            //Tarih aralığı seçimi
            $("#jqxDateTimeInput").jqxDateTimeInput({ width: '300px', height: '25px', selectionMode:'range' });

            $("#jqxDateTimeInput").on('change', function (event) {

                //Seçilen tarih aralığı selection nesnesinin içine from ve to olarak geliyor
                var selection = $("#jqxDateTimeInput").jqxDateTimeInput('getRange');
                
                fromDate = selection.from;
                toDate = selection.to;
                fromDate = formatDate(fromDate);
                toDate = formatDate(toDate);
                $('#grid').jqxGrid('updatebounddata', 'cells');
            });

            fromDate = formatDate(fromDate);
            toDate = formatDate(toDate);

            $("#jqxDateTimeInput").jqxDateTimeInput('setRange', fromDate, toDate);
            
            // tarihi yyyy-mm-dd formatına çevirir.
            function formatDate(date) {
                var d = new Date(date),
                    month = '' + (d.getMonth() + 1),
                    day = '' + d.getDate(),
                    year = d.getFullYear();

                if (month.length < 2) month = '0' + month;
                if (day.length < 2) day = '0' + day;

                return [year, month, day].join('-');
            }

            
            // prepare the data
           

            var url = "http://192.168.1.7:8388/api/AllVisits"; // + param1
        

            var source =
            {

                datatype: "json",
                datafields:
                    [
                        { name: 'VisitID', type: 'int' },
                        { name: 'IdNumber', type: 'string' },
                        { name: 'EntryTime', type: 'date' },
                        { name: 'ExitTime', type: 'date' },
                        { name: 'CreateDateTime', type: 'date' },
                        { name: 'CreateUserID', type: 'string' },
                        { name: 'Topic', type: 'string' },
                        { name: 'VisitedName', type: 'string' },
                        { name: 'IsStaff', type: 'bool' },
                        { name: 'VisitorName', type: 'string' },
                        { name: 'VisitorSurname', type: 'string' },
                        { name: 'AccessCardName', type: 'int' },
                        { name: 'AccessCardID', type: 'int' },
                        { name: 'CompanyName', type: 'string' },
                        { name: 'CompanyID', type: 'int' },
                        { name: 'VisitorTypeID', type: 'int' },
                        { name: 'VisitorTypeName', type: 'string' },
                        { name: 'AccessCardNumber', type: 'string' }
                       

                    ],
                url: url
            };
            var dataAdapter = new $.jqx.dataAdapter(source,
                {
                    formatData: function (data) {
                        $.extend(data, {
                           fromDate: fromDate,
                           toDate: toDate
                        });
                        return data;
                    }
                }
            );
            // initialize jqxGrid
            $("#grid").jqxGrid(
                {
                    width: '1070 px',
                    height: '500 px',
                    source: dataAdapter,
                    altrows: true,
                    sortable: true,
                    selectionmode: 'multiplecellsextended',
                    columns: [
                        // { text: 'VisitID', datafield: 'VisitID', width: 90 },
                        { text: 'TC Kimlik', datafield: 'IdNumber', width: 115 },
                        { text: 'Giriş Saati', datafield: 'EntryTime', width: 170, cellsformat: 'dd.MM.yyyy HH:mm:ss' },
                        { text: 'Çıkış Saati', datafield: 'ExitTime', width: 170, cellsformat: 'dd.MM.yyyy HH:mm:ss' }, 
                        // { text: 'CreateDateTime', datafield: 'CreateDateTime', width: 120, align: 'left', cellsalign: 'left' }, //, cellsformat: 'd'
                        // { text: 'CreateUserID', datafield: 'CreateUserID', width: 200, align: 'left', cellsalign: 'left' },
                        // { text: 'Topic', datafield: 'Topic', width: 200, cellsalign: 'left', align: 'left', cellsformat: 'c2' },
                        // { text: 'IsStaff', datafield: 'IsStaff', width: 120, align: 'left', cellsalign: 'left' },
                        { text: 'Ad', datafield: 'VisitorName', width: 130, align: 'left', cellsalign: 'left' },
                        { text: 'Soyad', datafield: 'VisitorSurname', width: 130, align: 'left', cellsalign: 'left' },
                        // { text: 'AccessCardName', datafield: 'AccessCardName', width: 120, align: 'left', cellsalign: 'left' },
                        // { text: 'AccessCardID', datafield: 'AccessCardID', width: 120, align: 'left', cellsalign: 'left' },
                        { text: 'Şirket', datafield: 'CompanyName', width: 120, align: 'left', cellsalign: 'left' },
                        { text: 'Kime', datafield: 'VisitedName', width: 150, align: 'left', cellsalign: 'left' },
                        { text: 'Kart', datafield: 'AccessCardName', width: 80, align: 'left', cellsalign: 'left' }
                        // { text: 'CompanyID', datafield: 'CompanyID', width: 120, align: 'left', cellsalign: 'left' },
                        // { text: 'VisitorTypeID', datafield: 'VisitorTypeID', width: 120, align: 'left', cellsalign: 'left' },

                        // { text: 'VisitorTypeName', datafield: 'VisitorTypeName', width: 120, align: 'left', cellsalign: 'left' },
                        // { text: 'AccessCardNumber', datafield: 'AccessCardNumber', width: 120, align: 'left', cellsalign: 'left' }
                    ]
                });
            $("#excelExport").jqxButton();
            $("#xmlExport").jqxButton();    
            $("#csvExport").jqxButton();
            $("#tsvExport").jqxButton();
            $("#jsonExport").jqxButton();
            $("#pdfExport").jqxButton();
            $("#excelExport").click(function () {
                $("#grid").jqxGrid('exportdata', 'xls', 'AllVisits');
            });
            $("#xmlExport").click(function () {
                $("#grid").jqxGrid('exportdata', 'xml', 'jqxGrid');
            });
            $("#csvExport").click(function () {
                $("#grid").jqxGrid('exportdata', 'csv', 'jqxGrid');
            });
            $("#tsvExport").click(function () {
                $("#grid").jqxGrid('exportdata', 'tsv', 'jqxGrid');
            });
            $("#jsonExport").click(function () {
                $("#grid").jqxGrid('exportdata', 'json', 'jqxGrid');
            });
            $("#pdfExport").click(function () {
                $("#grid").jqxGrid('exportdata', 'pdf', 'jqxGrid');
            });
        });

    </script>
</body>

</html>